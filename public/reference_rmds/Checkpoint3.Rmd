---
title: "Checkpoint 3"
author: "Raven McKnight"
date: "4/10/2019"
output: 
  html_document:
    toc: true
    toc_float: true
theme: lumen
---

```{r include = FALSE}
library(ggplot2)
library(tidyverse)
library(sf)
```

```{r message=FALSE}
ravenWorkingData <- read_csv("ravens_working_data.csv")
state_totals <- read_csv("rough_state_totals.csv")
```

# Data Introduction
I am working with data about women in need of publicly funded birth control and publicly funded birth control clinics in the United States. The data was collected by the Guttmacher Institute in 2014-2015 as a part of their ongoing research and data collection regarding contraception, abortion, pregnancy, etc. I was inspired by the organization Power to Decide to research contraceptive deserts, defined approximately by Richard Cooper, MD as areas where birth control clinics have to serve 1000 or more patients each. I have selected some covariates from the 2015 ACS 5-Year estimates to better understand who lives in these deserts. 

My data is still a bit messy/incomplete and the visualizations in this checkpoint aren't the best I've ever done. This data has never really been compiled publicly and I haven't found a lot of literature about which covariates to include so I'd consider this a work in progress! I will have more time to refine it this coming week!

| **variable**              | **meaning**                                                                                                               |
|---------------------------|---------------------------------------------------------------------------------------------------------------------------|
| TotalClinics              | Number of publicly funded clinics providing birth control services by county, Guttmacher                                  |
| TotalWomen                | Total women age 13-44 who can become pregnant but don't want to *and* who need publicly funded contraceptives, Guttmacher |
| TotalWomenUnder20         | Total women under 20 who need publicly funded services, Guttmacher                                                        |
| State                     | US State                                                                                                                  |
| County                    | US County                                                                                                                 |
| fips                      | Geographic ID for mapping & joining to census data                                                                        |
| TotalPop                  | Total county population, ACS 2015                                                                                         |
| MedianInc                 | Median county income, ACS 2015                                                                                            |
| PercHSGrad                | Percent of county with high school diploma or equivalent, ACS 2015                                                        |
| PercPoverty               | Percent of county living below poverty line, ACS 2015                                                                     |
| PercWhite, PercBlack .... | Seven variables recording racial demographics of each county, ACS 2015                                                    |
| WomenPerClinic            | Simple ratio of TotalWomen/TotalClinics                                                                                   |
| PercRural                 | Percent of population living in rural area, ACS 2015                                                                      |


I think that this data needs a little more cleaning & research into which covariates to include. I think I'm going to add the results of the 2012 election by county. I had this in the dataset for a while but it was causing problems with Maine for some reason. Working through making these visualizations, I think I'd like to add a yes/no variable for whether the county is a desert and for whether Obama won. I also want to make a "type" variable for types of clinics. I also haven't joined anything spatially yet!


# Data Summary
```{r}
dim(ravenWorkingData)
```

```{r}
names(ravenWorkingData)
```
```{r}
head(ravenWorkingData)
```
```{r}
summary(ravenWorkingData)
```

# Visualization

First, let's look at the distribution of WomenPerClinic to get an idea of how many counties/women are in contracepive deserts. 
```{r}
p <- ggplot(ravenWorkingData, aes(x=WomenPerClinic)) +
  geom_density() +
  lims(x=c(0, 10000)) + # restricting to get rid of huge outliers
  labs(x= "Women Per Clinic", y= "Density") +
  theme_minimal()

d <- ggplot_build(p)$data[[1]]

p + geom_area(data=subset(d, x > 1000), aes(x=x, y=y), fill="red")
```

Oof. The mean value of WomenPerClinic is 1667.1, so we can see right off the bat that many women live in areas of limited access. 


My first thought is that poor, rural areas have limited access. 
```{r}
ggplot(ravenWorkingData, aes(x=PercRural, y=WomenPerClinic, color=PercPoverty)) +
  geom_point() +
  lims(y=c(0, 10000)) +
  labs(x="Percent Rural Residents", y="Women Per Clinic") +
  theme_minimal()
```

Unintuitively, there seems to be a (weak) negative correlation between rurality and women per clinic. From this view, I can't see any correlation between poverty and women per clinic. 


I think I need to explore the relationships between my covariates more, too. 
```{r}
ravenWorkingData <- ravenWorkingData %>%
  mutate(desert = if_else(WomenPerClinic > 1000, "Yes", "No"))

ggplot(na.omit(ravenWorkingData), aes(x=PercPoverty, y=(100-PercHSGrad), color=desert)) +
  geom_point(alpha=0.5) +
  labs(x="Percent Living in Poverty", y="Percent Without High School Diploma") +
  theme_minimal()
```

These plots are maybe not the *most* informative and probably won't make it to the final report but they are proving me wrong right off the bat. Firstly, my covariates aren't related to each other in the ways I expected (I really though poverty and high school grad rate would be more correlated). Additionally, it looks like poverty has less of a correlation with limited access than education status. I wonder what the relationship between graduating high school and living near a birth control clinic is. Something to do with urban areas? 

The last obvious thing I wanted to check at this point is whether race is correlated with deserts. 

```{r}
ggplot(na.omit(ravenWorkingData), aes(x=PercWhite, fill=desert)) +
  geom_density(alpha=0.5) +
  lims(x=c(0, 100)) + # restricting to get rid of huge outliers
  labs(x= "Percent White", y= "Density") +
  theme_minimal()
```

Above 50 percent white, I see about the pattern I would expect. Interesting that very non-white areas appear to have less deserts. These relationships will be easier to check out in maps ones I join to a shapefile. 

I think what I've learned on this checkpoint is a) building a dataset is hard and b) these covariates aren't interacting in the ways I expected! There are some new variables I think I'm going to add/create and hopefully I will be able to do some more meaningful analysis and geospatial visualization this week. 
